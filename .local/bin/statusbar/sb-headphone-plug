#!/bin/bash

set -euo pipefail

# This loop will update the volume statusbar module whenever headphones
# are connected or disconnected.
# https://linux.die.net/man/8/acpid
# https://unix.stackexchange.com/a/128007
#
# Ubuntu package: https://manpages.ubuntu.com/manpages/noble/man8/acpi_listen.8.html
# Arch: https://wiki.archlinux.org/title/Acpid
#
# After installing, enable acpid.service

ifinstalled acpi_listen || exit 1

acpi_listen | grep --line-buffered -F 'jack/headphone HEADPHONE' | while read -r line; do
	pkill -RTMIN+10 "${STATUSBAR:-i3blocks}"
done
